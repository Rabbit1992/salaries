<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¿®å¤åçš„å·¥èµ„æŸ¥è¯¢ç³»ç»Ÿæµ‹è¯•</title>
    <link rel="stylesheet" href="styles/main.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .test-panel {
            position: fixed;
            top: 10px;
            right: 10px;
            background: #fff;
            border: 2px solid #007bff;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 1000;
            max-width: 300px;
        }
        .test-panel h3 {
            margin: 0 0 10px 0;
            color: #007bff;
            font-size: 16px;
        }
        .test-btn {
            display: block;
            width: 100%;
            margin: 5px 0;
            padding: 8px 12px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }
        .test-btn:hover {
            background: #0056b3;
        }
        .test-log {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 10px;
            margin-top: 10px;
            max-height: 200px;
            overflow-y: auto;
            font-size: 12px;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- æµ‹è¯•é¢æ¿ -->
        <div class="test-panel">
            <h3>ğŸ”§ DOMä¿®å¤æµ‹è¯•</h3>
            <button class="test-btn" onclick="testDOMElements()">æ£€æŸ¥DOMå…ƒç´ </button>
            <button class="test-btn" onclick="testErrorDisplay()">æµ‹è¯•é”™è¯¯æ˜¾ç¤º</button>
            <button class="test-btn" onclick="testPasswordStrength()">æµ‹è¯•å¯†ç å¼ºåº¦</button>
            <button class="test-btn" onclick="simulateLogin()">æ¨¡æ‹Ÿç™»å½•</button>
            <button class="test-btn" onclick="clearLog()">æ¸…é™¤æ—¥å¿—</button>
            <div id="testLog" class="test-log"></div>
        </div>

        <!-- å¤´éƒ¨åŒºåŸŸ -->
        <header class="app-header">
            <div class="header-content">
                <h1 class="app-title">å·¥èµ„æŸ¥è¯¢ç³»ç»Ÿ - ä¿®å¤æµ‹è¯•ç‰ˆ</h1>
                <div class="user-section">
                    <div class="user-info">
                        <i class="fas fa-user-circle"></i>
                        <span id="userInfo">åŠ è½½ä¸­...</span>
                    </div>
                    <button id="changePasswordBtn" class="change-password-btn" title="ä¿®æ”¹å¯†ç ">
                        <i class="fas fa-key"></i>
                    </button>
                    <button id="logoutBtn" class="logout-btn" title="é€€å‡ºç™»å½•">
                        <i class="fas fa-sign-out-alt"></i>
                    </button>
                </div>
            </div>
        </header>

        <!-- ä¸»å†…å®¹åŒºåŸŸ -->
        <main class="main-content">
            <!-- æŸ¥è¯¢é¢æ¿ -->
            <section class="query-section">
                <div class="query-card">
                    <div class="form-group">
                        <label for="monthSelect">
                            <i class="fas fa-calendar-alt"></i>
                            æœˆä»½
                        </label>
                        <select id="monthSelect" class="form-select">
                            <option value="">è¯·é€‰æ‹©æŸ¥è¯¢æœˆä»½</option>
                        </select>
                    </div>
                    <div class="form-actions">
                        <button id="queryBtn" class="btn-primary">
                            æŸ¥è¯¢
                        </button>
                    </div>
                </div>
            </section>

            <!-- å·¥èµ„åˆ—è¡¨ -->
            <section id="salaryResult" class="salary-list-section" style="display: none;">
                <div class="salary-list" id="salaryList">
                    <!-- åŠ¨æ€ç”Ÿæˆçš„å·¥èµ„åˆ—è¡¨é¡¹ -->
                </div>
            </section>

            <!-- æ¶ˆæ¯æç¤º -->
            <div id="noDataMessage" class="message-card info" style="display: none;">
                <div class="message-icon">
                    <i class="fas fa-info-circle"></i>
                </div>
                <div class="message-content">
                    <h3>æš‚æ— æ•°æ®</h3>
                    <p>æœªæ‰¾åˆ°è¯¥æœˆä»½çš„å·¥èµ„è®°å½•ï¼Œè¯·é€‰æ‹©å…¶ä»–æœˆä»½æŸ¥è¯¢</p>
                </div>
            </div>
            
            <div id="errorMessage" class="message-card error" style="display: none;">
                <div class="message-icon">
                    <i class="fas fa-exclamation-triangle"></i>
                </div>
                <div class="message-content">
                    <h3>æŸ¥è¯¢å¤±è´¥</h3>
                    <p id="errorText">è¯·ç¨åé‡è¯•æˆ–è”ç³»ç³»ç»Ÿç®¡ç†å‘˜</p>
                </div>
            </div>
        </main>
    </div>
    
    <!-- åŠ è½½åŠ¨ç”» -->
    <div id="loadingOverlay" class="loading-overlay" style="display: none;">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <p>æ­£åœ¨åŠ è½½æ•°æ®...</p>
        </div>
    </div>
    
    <!-- ä¿®æ”¹å¯†ç æ¨¡æ€æ¡† -->
    <div id="changePasswordModal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ä¿®æ”¹å¯†ç </h3>
                <button id="closeModalBtn" class="close-modal-btn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="changePasswordForm">
                    <div class="form-group">
                        <label for="currentPassword">
                            <i class="fas fa-lock"></i>
                            å½“å‰å¯†ç 
                        </label>
                        <input type="password" id="currentPassword" name="currentPassword" placeholder="è¯·è¾“å…¥å½“å‰å¯†ç " required>
                    </div>
                    <div class="form-group">
                        <label for="newPassword">
                            <i class="fas fa-key"></i>
                            æ–°å¯†ç 
                        </label>
                        <input type="password" id="newPassword" name="newPassword" placeholder="è¯·è¾“å…¥æ–°å¯†ç " required>
                    </div>
                    <div class="form-group">
                        <label for="confirmPassword">
                            <i class="fas fa-check-circle"></i>
                            ç¡®è®¤æ–°å¯†ç 
                        </label>
                        <input type="password" id="confirmPassword" name="confirmPassword" placeholder="è¯·å†æ¬¡è¾“å…¥æ–°å¯†ç " required>
                    </div>
                    <div class="password-strength">
                        <div class="strength-indicator">
                            <div class="strength-bar" id="strengthBar"></div>
                        </div>
                        <span class="strength-text" id="strengthText">å¯†ç å¼ºåº¦ï¼šå¼±</span>
                    </div>
                    <div class="form-actions">
                        <button type="button" id="cancelChangeBtn" class="btn-secondary">å–æ¶ˆ</button>
                        <button type="submit" class="btn-primary">
                            <span class="btn-text">ç¡®è®¤ä¿®æ”¹</span>
                            <span class="btn-loading" style="display: none;">ä¿®æ”¹ä¸­...</span>
                        </button>
                    </div>
                </form>
                <div id="changePasswordError" class="error-message" style="display: none;"></div>
                <div id="changePasswordSuccess" class="success-message" style="display: none;"></div>
            </div>
        </div>
    </div>
    
    <script>
        // æµ‹è¯•å‡½æ•°
        function log(message) {
            const testLog = document.getElementById('testLog');
            const timestamp = new Date().toLocaleTimeString();
            testLog.innerHTML += `[${timestamp}] ${message}<br>`;
            testLog.scrollTop = testLog.scrollHeight;
        }
        
        function clearLog() {
            document.getElementById('testLog').innerHTML = '';
        }
        
        function testDOMElements() {
            log('=== DOMå…ƒç´ æ£€æŸ¥ ===');
            const elements = [
                'userInfo', 'logoutBtn', 'changePasswordBtn', 'monthSelect', 'queryBtn',
                'salaryResult', 'noDataMessage', 'errorMessage', 'errorText',
                'loadingOverlay', 'changePasswordModal', 'strengthBar'
            ];
            
            elements.forEach(id => {
                const element = document.getElementById(id);
                log(`${id}: ${element ? 'âœ… å­˜åœ¨' : 'âŒ ä¸å­˜åœ¨'}`);
            });
            
            // æ£€æŸ¥classé€‰æ‹©å™¨
            const classElements = [
                '.password-strength',
                '.strength-text',
                '#changePasswordForm button[type="submit"]'
            ];
            
            classElements.forEach(selector => {
                const element = document.querySelector(selector);
                log(`${selector}: ${element ? 'âœ… å­˜åœ¨' : 'âŒ ä¸å­˜åœ¨'}`);
            });
        }
        
        function testErrorDisplay() {
            log('=== æµ‹è¯•é”™è¯¯æ˜¾ç¤º ===');
            // æ¨¡æ‹ŸshowErrorå‡½æ•°
            const errorText = document.getElementById('errorText');
            const errorMessage = document.getElementById('errorMessage');
            
            if (errorText) {
                errorText.textContent = 'è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•é”™è¯¯æ¶ˆæ¯';
                log('âœ… é”™è¯¯æ–‡æœ¬è®¾ç½®æˆåŠŸ');
            } else {
                log('âŒ errorTextå…ƒç´ ä¸å­˜åœ¨');
            }
            
            if (errorMessage) {
                errorMessage.style.display = 'block';
                log('âœ… é”™è¯¯æ¶ˆæ¯æ˜¾ç¤ºæˆåŠŸ');
                
                setTimeout(() => {
                    errorMessage.style.display = 'none';
                    log('âœ… é”™è¯¯æ¶ˆæ¯è‡ªåŠ¨éšè—');
                }, 3000);
            } else {
                log('âŒ errorMessageå…ƒç´ ä¸å­˜åœ¨');
            }
        }
        
        function testPasswordStrength() {
            log('=== æµ‹è¯•å¯†ç å¼ºåº¦ ===');
            const strengthBar = document.getElementById('strengthBar');
            const strengthText = document.querySelector('.strength-text');
            
            if (strengthBar) {
                strengthBar.className = 'strength-bar strong';
                strengthBar.style.width = '80%';
                log('âœ… å¯†ç å¼ºåº¦æ¡æ›´æ–°æˆåŠŸ');
            } else {
                log('âŒ strengthBarå…ƒç´ ä¸å­˜åœ¨');
            }
            
            if (strengthText) {
                strengthText.textContent = 'å¯†ç å¼ºåº¦ï¼šå¼º';
                log('âœ… å¯†ç å¼ºåº¦æ–‡æœ¬æ›´æ–°æˆåŠŸ');
            } else {
                log('âŒ å¯†ç å¼ºåº¦æ–‡æœ¬å…ƒç´ ä¸å­˜åœ¨');
            }
        }
        
        function simulateLogin() {
            log('=== æ¨¡æ‹Ÿç™»å½•æµ‹è¯• ===');
            // è®¾ç½®æµ‹è¯•ç”¨æˆ·ä¿¡æ¯
            const testUser = {
                username: 'test.user',
                department: 'æµ‹è¯•éƒ¨é—¨'
            };
            
            localStorage.setItem('currentUser', JSON.stringify(testUser));
            log('âœ… ç”¨æˆ·ä¿¡æ¯å·²ä¿å­˜åˆ°localStorage');
            
            // æ¨¡æ‹Ÿé¡µé¢åˆå§‹åŒ–
            const userInfo = document.getElementById('userInfo');
            if (userInfo) {
                userInfo.textContent = `æ¬¢è¿ï¼Œ${testUser.username} (${testUser.department})`;
                log('âœ… ç”¨æˆ·ä¿¡æ¯æ˜¾ç¤ºæˆåŠŸ');
            } else {
                log('âŒ userInfoå…ƒç´ ä¸å­˜åœ¨');
            }
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåæ˜¾ç¤ºæµ‹è¯•ä¿¡æ¯
        document.addEventListener('DOMContentLoaded', function() {
            log('ğŸš€ ä¿®å¤åçš„å·¥èµ„æŸ¥è¯¢ç³»ç»Ÿæµ‹è¯•é¡µé¢å·²åŠ è½½');
            log('ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®è¿›è¡Œå„é¡¹åŠŸèƒ½æµ‹è¯•');
        });
    </script>
    
    <script src="scripts/salary.js"></script>
</body>
</html>